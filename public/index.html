<!DOCTYPE html>
<html lang="en" style="width: 100%; height: 100%">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style type="text/css">body { font-family: monospace; }</style>
    <link id="font" href="" rel="stylesheet">
    <title>Dydu Chatbox</title>
    <script type="module">
      window.DYDU_QUALIFICATION_MODE = true;

      if (window.location.href.includes("iframeurl=")) {
        document.body.style.padding = "0"; // remove all margin to have the iframe on the whole page

        // search all the span inside the first div and hide them
        const spanList = document.getElementById("chatbot-external").getElementsByTagName('span');
        for (let i = 0; i < spanList.length; i++) {
          spanList[i].style.display="none";
        }

        // retrieve the iframe element and give it dynamically the url passed in the query "iframeurl" to display the website behind the chatbox
        const ifrm = document.getElementById("iframe");
        const params = new Proxy(new URLSearchParams(window.location.search), {
          get: (searchParams, prop) => searchParams.get(prop),
        });
        // Get the value of "some_key" in eg "https://example.com/?some_key=some_value"
        let iframeurlValue = params.iframeurl; // "some_value"

        iframeurlValue = iframeurlValue.replace('https://', '');
        ifrm.setAttribute("src", `https://${iframeurlValue}`);
        ifrm.style.display = "block";
      }
    </script>
  </head>
  <body style="width: inherit; height: inherit; margin: 0; padding: 8px 0 0 8px;">
    <div id="chatbot-external" style="width: inherit; height: inherit;">
      <span style="color: #FF4081">v<%= version %></span>
      <span style="color: #03A9F4"><%= now %></span>
      <span><%= hash %></span>
      <iframe id="iframe" style="width:inherit;height:inherit;display:none"></iframe>
    </div>
    <div id="dydu-root"></div>
  </body>
</html>